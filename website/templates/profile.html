{% extends "base.html" %}
<<<<<<< HEAD

{% block title %}{{ user_profile.first_name }}'s Profile{% endblock %}

{% block content %}
<div class="container">
    <div class="section">
        <h2 align="center">{{ user_profile.first_name }}'s Profile</h2>
        <p><strong>Email:</strong> {{ user_profile.email }}</p>
        
        <h4 class="mt-4">My Workouts</h4>
        {% if user_profile.workouts.all() %}
            {% for workout in user_profile.workouts %}
                <span class="badge badge-success" style="font-size: 1rem; margin: 0.2rem;">{{ workout.name }}</span>
            {% endfor %}
        {% else %}
            <p class="text-muted">No workouts added yet.</p>
        {% endif %}
    </div>

    <!-- Display Workout Partner -->
    <div class="section">
        <h4>My Workout Partner</h4>
        {% if user_profile.partner %}
            <div class="list-group-item d-flex justify-content-between align-items-center">
                <div>
                    <strong>{{ user_profile.partner.first_name }}</strong>
                    <a href="{{ url_for('views.profile', user_id=user_profile.partner.id) }}" class="btn btn-sm btn-info ml-2">View Profile</a>
                </div>
                {% if user_profile.id == user.id %}
                <form action="{{ url_for('views.remove_partner') }}" method="POST" style="display: inline;">
                    <button type="submit" class="btn btn-sm btn-danger">Remove Partner</button>
                </form>
                {% endif %}
            </div>
        {% else %}
            <p>No workout partner assigned.</p>
        {% endif %}
    </div>

    <!-- Display Suggested Partners (only on the logged-in user's own profile) -->
    {% if user_profile.id == user.id and suggested_partners %}
    <div class="section">
        <h4>Suggested Workout Partners</h4>
        <div class="list-group">
            {% for partner in suggested_partners %}
            <div class="list-group-item list-group-item-action flex-column align-items-start mb-2">
                <div class="d-flex w-100 justify-content-between align-items-center">
                    <div>
                        <h5 class="mb-1">{{ partner.first_name }}</h5>
                        <small>
                            Shared Workouts:
                            {% for p_workout in partner.workouts %}
                                {% if p_workout in user.workouts %}
                                    <span class="badge badge-primary">{{ p_workout.name }}</span>
                                {% endif %}
                            {% endfor %}
                        </small>
                    </div>
                    <div>
                        <a href="{{ url_for('views.profile', user_id=partner.id) }}" class="btn btn-sm btn-info">View</a>
                        <!-- Add Partner Button (only show if user has no partner) -->
                        {% if not user.partner %}
                        <form action="{{ url_for('views.add_partner', partner_id=partner.id) }}" method="POST" style="display: inline;">
                            <button type="submit" class="btn btn-sm btn-success">Add Partner</button>
                        </form>
                        {% endif %}
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
=======
{% block title %}Profile{% endblock %}
{% block content %}
<h2 align="center">My Profile</h2>

{% with messages = get_flashed_messages(with_categories=true) %}
  {% if messages %}
    {% for category, message in messages %}
      <div class="alert alert-{{ category }}" role="alert">
        {{ message }}
      </div>
    {% endfor %}
  {% endif %}
{% endwith %}

<form method="POST">
  <div class="form-group">
    <label for="email">Email (cannot change)</label>
    <input type="text" class="form-control" id="email" value="{{ user.email }}" readonly>
  </div>

  <div class="form-group">
    <label for="firstName">First Name (cannot change)</label>
    <input type="text" class="form-control" id="firstName" value="{{ user.first_name }}" readonly>
  </div>

  <div class="form-group">
    <label for="bio">Bio</label>
    <textarea class="form-control" id="bio" name="bio">{{ user.bio }}</textarea>
  </div>

  <div class="form-group">
    <label for="phone_number">Phone Number:</label>
    <input 
    type="text" 
    name="phone_number" 
    value="{{ current_user.phone_number }}" 
    pattern="\d{11}" 
    maxlength="11" 
    title="Phone number must be exactly 11 digits" 
    required>
  </div>

  <div class="form-group">
  <label>Activity Type (pick up to 3):</label><br>
  <input type="checkbox" name="activities" value="swimming" {% if user.activity_types and 'swimming' in user.activity_types %}checked{% endif %}> Swimming<br>
  <input type="checkbox" name="activities" value="jogging" {% if user.activity_types and 'jogging' in user.activity_types %}checked{% endif %}> Jogging<br>
  <input type="checkbox" name="activities" value="hiking" {% if user.activity_types and 'hiking' in user.activity_types %}checked{% endif %}> Hiking<br>
  <input type="checkbox" name="activities" value="cycling" {% if user.activity_types and 'cycling' in user.activity_types %}checked{% endif %}> Cycling<br>
  <input type="checkbox" name="activities" value="pilates" {% if user.activity_types and 'pilates' in user.activity_types %}checked{% endif %}> Pilates<br>
  <input type="checkbox" name="activities" value="yoga" {% if user.activity_types and 'yoga' in user.activity_types %}checked{% endif %}> Yoga<br>
  <input type="checkbox" name="activities" value="badminton" {% if user.activity_types and 'badminton' in user.activity_types %}checked{% endif %}> Badminton<br>
  <input type="checkbox" name="activities" value="tennis" {% if user.activity_types and 'tennis' in user.activity_types %}checked{% endif %}> Tennis<br>
  <input type="checkbox" name="activities" value="football" {% if user.activity_types and 'football' in user.activity_types %}checked{% endif %}> Football<br>
  <input type="checkbox" name="activities" value="basketball" {% if user.activity_types and 'basketball' in user.activity_types %}checked{% endif %}> Basketball<br>
  <input type="checkbox" name="activities" value="volleyball" {% if user.activity_types and 'volleyball' in user.activity_types %}checked{% endif %}> Volleyball<br>
  <input type="checkbox" name="activities" value="squash" {% if user.activity_types and 'squash' in user.activity_types %}checked{% endif %}> Squash<br>
  </div>


  <button type="submit" class="btn btn-primary">Update Profile</button>
</form>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const checkboxes = document.querySelectorAll('input[name="activities"]');
    checkboxes.forEach(cb => {
      cb.addEventListener("change", function () {
        const checked = document.querySelectorAll('input[name="activities"]:checked');
        if (checked.length > 3) {
          this.checked = false; // untick the last one
          alert("⚠️ You can only select up to 3 activities.");
        }
      });
    });
  });
</script>
>>>>>>> 52f7f308b51553a79ba653d24b23c08003eb6ea4
{% endblock %}
